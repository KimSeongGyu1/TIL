# 운영체제와 정보기술의 원리(반효경)

### 5장(프로세스 관리)

<details>
  <summary> 프로세스의 개념 </summary>
  </br>
  <p>프로세스란 실행 중인 프로그램을 뜻한다</p>
  <p>일반적으로 job이라는 용어와 process를 혼용해 사용하기도 한다</p>
  <p>시분할 시스템 환경에서 프로세스의 재시작 시점을 정확히 재현할 필요가 있다</p>
  <p>이 때 정확한 재현을 위해 필요한 정보를 프로세스의 문맥(context)라 한다</p>
  <summary> 프로세스 문맥의 종류 </summary>
    </br>
    <p>프로세스의 문맥을 크게 3가지로 분류하면 하드웨어 문맥, 프로세스의 주소 공간, 커널상의 문맥으로 나눌 수 있다</p>
    <p>하드웨어 문맥은 CPU의 수행상태를 나타내며 PC와 레지스터에 저장하고 있는 값들을 의미한다</p>
    <p>프로세스는 코드, 데이터, 스택으로 구성되는 자신만의 주소공간을 가지며 이는 문맥의 중요한 요소이다</p>
    <p>운영체제는 PCB와 커널스택을 이용해 프로세스를 관리하며 이는 커널상의 문맥이다</p>
</details>
<hr>

<details>
  <summary> 프로세스의 상태 </summary>
  </br>
  <p>프로세스의 상태는 실행(running), 준비(ready), 봉쇄(blocked, wait, sleep)으로 구분할 수 있다</p>
  <p>실행은 CPU를 차지하고 있는 상태이고 한번에 하나의 프로세스만 CPU를 차지할 수 있다</p>
  <p>준비는 CPU를 차지하기 위해 대기하는 상태이다. CPU를 할당받으면 연산을 할 수 있다</p>
  <p>봉쇄는 CPU를 차지해도 연산을 할 수 없는 상태이다</p>
  <p>이 밖에 프로세스가 생성 중인 시작(new) 상태, 종료 중인 완료(terminated) 상태도 있다</p>
  <p>중기 스케줄러 이후부터는 중지(suspended, stopped)상태도 추가되었다</p>
  <details>
    <summary> 문맥 교환(context switching) </summary>
    </br>
    <p>CPU에 새로운 프로세스를 할당하기 위해 수행중이던 프로세스의 문맥을 저장하고 새로운 프로세스의 문맥을 세팅하는 과정을 문맥교환(context switching)이라 한다</p>
    <p>타이머 인터럽트가 발생하는 경우, 실행 상태에 있던 프로세스가 입출력 요청등으로 봉쇄 상태로 바뀌는 경우 등에 일어난다</p>
    <p>이 때 준비 상태에 있던 프로세스가 CPU를 할당받는 과정을 CPU 디스패치(dispatch)라 한다</p>
  </details>
</details>
<hr>

<details>
  <summary> 프로세스 제어블록(PCB) </summary>
  </br>
  <p>PCB는 다음과 같은 구성요소들로 이루어 진다</p>
  <p>프로세스의 상태(state)</p>
  <p>- CPU를 할당해도 되는지 여부를 결정하기 위해 필요</p>
  <p>프로그램 카운터(PC)의 값</p>
  <p>- 다음에 수행할 명령의 위치</p>
  <p>CPU 레지스터 값</p>
  <p>- CPU연산을 위해 현 시점에 레지스터에 어떤 값이 있었는지</p>
  <p>CPU 스케쥴링 정보</p>
  <p>메모리 관리 정보</p>
  <p>자원 사용 정보</p>
  <p>입출력 상태 정보</p>
</details>
<hr>

<details>
  <summary> 문맥교환(context switching) </summary>
  </br>
  <p>문맥교환이란 하나의 사용자 프로세스로부터 다른 사용자 프로세스로 CPU의 제어권이 이양되는 과정을 의미한다</p>
  <p>시스템콜로 CPU 제어권이 운영체제에게 넘어가 커널의 코드가 실행되는 것을 문맥교환이라 하지는 않는다</p>
  <p>문맥교환은 시스템콜에 비해 훨씬 많은 오버헤드가 뒤따른다</p>
</details>
<hr>

<details>
  <summary> 프로세스를 스케줄링하기 위한 큐 </summary>
  </br>
  <p>운영체제는 준비 상태의 프로세스들을 준비 큐(ready queue)에 두고 순서대로 CPU를 할당한다</p>
  <p>그 외에도 특정 자원을 기다리는 프로세스들을 줄 세우기 위해 자원별로 장치 큐(device queue)를 둔다</p>
  <p>디스크 입출력 큐, 키보드 입출력 큐, 화면 출력 큐 등등이 장치큐에 해당한다</p>
  <p>하드웨어 외에도 공유 데이터에 대한 큐도 존재하여 데이터의 일관성을 지키도록 한다</p>
  <p>운영체제는 다양한 큐를 두어 프로세스를 관리한다</p>
  <p>운영체제는 작업 큐(job queue)도 유지하는데 모든 프로세스는 상태와 무관하게 작업 큐에 속하여 관리된다</p>
</details>
<hr>

<details>
  <summary> 스케줄러 </summary>
  </br>
  <p>스케줄러란 어떤 프로세스에 자원을 할당할지를 결정하는 운영체제 커널의 코드를 지칭한다</p>
  <details>
    <summary> 장기 스케줄러 </summary>
    </br>
    <p>작업 스케줄러(job scheduler)라고도 불린다</p>
    <p>어떤 프로세스를 준비 큐에 진입시킬지 결정하는 역할을 한다</p>
    <p>준비 큐는 CPU만 얻으면 당장 실행될 수 있는 프로세스의 집합이므로 메모리가 할당되있어야 한다</p>
    <p>준비 큐를 관리하며 메모리 할당에도 관여한다</p>
    <p>수십초 내비 수 분 단위로 호출되며 속도가 느린 것이 허용된다</p>
  </details>
  <details>
    <summary> 단기 스케줄러 </summary>
    </br>
    <p>CPU 스케줄러라고도 불린다</p>
    <p>준비 상태의 프로세스 중에서 어떤 프로세스를 다음번에 실행상태로 만들지 결정한다</p>
    <p>밀리초 단위로 매우 빈번히 호출되기 때문에 수행속도가 빠르다</p>
  </details>
  <details>
    <summary> 중기 스케줄러 </summary>
    </br>
    <p>현대의 시분할 시스템에서는 장기 스케줄러를 두지 않는 경우가 많다</p>
    <p>자원이 빈약하지 않기 때문에 자원을 지나치게 효율적으로 관리할 필요가 없다</p>
    <p>대신 중기 스케줄러를 두는 경우가 많다</p>
    <p>중기 스케줄러는 너무 많은 프로세스에 메모리가 할당되었을 때 이를 동적으로 조절하기 위해 추가되었다</p>
    <p>메모리가 가득찼을 때 일부 프로세스로 부터 메모리를 빼앗아 디스크의 스왑 영역에 저장해둔다</p>
    <p>이를 스왑 아웃이라 부른다</p>
  </details>
</details>
<hr>

<details>
  <summary> 프로세스의 생성 </summary>
  </br>
  <p>시스템 부팅 후 최초의 프로세스는 운영체제에 의해 생성되지만, 그 다음부터는 이미 존재하는 프로세스가 다른 프로세스를 복제 생성한다</p>
  <p>이때 이 둘을 부모 프로세스와 자식 프로세스라 한다</p>
  <p>일반적으로 후손 프로세스가 모두 종료되어야 본인이 종료될 수 있다</p>
  <p>종료에는 자발적 종료와 비 자발적 종료의 두 종류가 생긴다</p>
  <p>부모가 종료될 때 자식들을 강제적으로 종료시키는 경우 비 자발적 종료가 이루어 진다</p>
  <p>프로세스의 자식으로 이양하여 강제종료를 피하는 방법도 있다</p>
</details>
<hr>

<details>
  <summary> 프로세스 간의 협력 </summary>
  </br>
  <p>프로세스는 다른 프로세스가 자신의 주소 공간을 참조하는 것을 허용하지 않는다</p>
  <details>
    <summary> IPC </summary>
    </br>
    <p>프로세스간의 협력을 위한 대표적인 매커니즘은 IPC(Inter-Process Communication)가 있다</p>
    <p>IPC는 프로세스간의 통신과 동기화를 이루기 위한 메커니즘이다</p>
    <p>IPC는 메시지 전달 방식과 공유 메모리 방식으로 나뉜다</p>
    <p>메시지 전달 방식은 공유 데이터를 사용하지 않고 커널을 통해 메시지를 주고받는다</p>
    <p>메시지 전달 방식은 다시 직접통신과 간접통신으로 나뉜다</p>
    <p>직접 통신은 프로세스에게 직접 메시지를 전송하고, 간접통신은 메일박스라는 저장공간에 메시지를 전송한다</p>
    <p>공유 메모리 방식은 프로세스들이 주소 공간의 일부를 공유한다</p>
  </details>
</details>
<hr>
